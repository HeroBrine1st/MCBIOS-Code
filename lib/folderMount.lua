local a=require("filesystem")local b=require("filesystem")local c=require("component")local d=require("computer")local e={}function e.mountFolder(f,g,h)if not type(f)=="string"then error("Bad argument #1 (String expected, got "..type(f)..")")end;if not type(g)=="string"then error("Bad argument #2 (String expected, got "..type(g)..")")end;if not type(h)=="boolean"then error("Bad argument #3 (Boolean expected, got "..type(h)..")")end;if not a.isDirectory(f)then error("Bad path (Directory expected, got file)")end;local i=b.get(f)local j={}j.convertPath=function(k)return b.concat(f,k)end;j.address="VirtualFS"..tostring(math.random(0x000000,0xFFFFFF))j.type="filesystem"j.label=j.address;j.spaceUsed=b.get(f).spaceUsed;j.spaceTotal=b.get(f).spaceTotal;j.makeDirectory=function(l)if h then b.get(f).makeDirectory(j.convertPath(l))else error("Permission Denied")end end;j.isReadOnly=function()return not h end;j.rename=function(m,n)if h then b.get(f).rename(j.convertPath(m),j.convertPath(n))else error("Permission Denied")end end;j.remove=function(o)if h then b.get(f).remove(j.convertPath(o))else error("Permission Denied")end end;j.setLabel=function(p)if h then j.label=p end end;j.size=function(k)return b.get(f).size(j.convertPath(k))end;j.getLabel=function()return j.label end;j.exists=function(k)return i.exists(j.convertPath(k))end;j.open=function(k,q)if h then return i.open(j.convertPath(k),q)else if q=="r"then return i.open(j.convertPath(k),"r")else error("Permission Denied")end end end;j.read=function(r,...)return i.read(r,...)end;j.close=function(r)return i.close(r)end;j.write=function(r,...)if h then return i.write(r,...)else error("Permission Denied")end end;j.seek=function(r,...)return i.seek(r,...)end;j.isDirectory=function(k)return i.isDirectory(j.convertPath(k))end;j.list=function(k)return i.list(j.convertPath(k))end;j.lastModified=function(k)return i.lastModified(j.convertPath(k))end;b.umount(g)b.mount(j,g)return j end;return e
