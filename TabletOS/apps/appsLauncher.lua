local a=require("pm")local b=require("shell")local c=require("zygote")local d=require("filesystem")local e=require("event")local f=require("ECSAPI")local g=c.addForm()g.left=1;g.top=2;g.W=80;g.H=23;local h=g:addList(1,1,function(i)local j=i.items[i.index]local k=c.addForm()k.left=30;k.top=12-2;k.W=20;k.H=3;windowButton1=k:addButton(1,1,"Execute",function()OSAPI.ignoreListeners()f.prepareToExit()local l,m=b.execute(j)if not l then f.error(m)end;OSAPI.init()g:setActive()end)windowButton2=k:addButton(1,2,"Uninstall",function()updateList()a.uninstallApp(d.name(j))g:setActive()end)windowButton3=k:addButton(1,3,"Exit",function()g:setActive()end)windowButton1.W=20;windowButton2.W=20;windowButton3.W=20;c.run(k)end)function updateList()h:clear()for n,o in pairs(a.listOfApps(true))do h:insert("SYSTEM "..d.name(o),o)end;for n,o in pairs(a.listOfApps(false))do h:insert(d.name(o),o)end end;h.W=80;h.H=23;h.color=0xCCCCCC;h.fontColor=0xFFFFFF-0xCCCCCC;h.border=0;local function p(n,n,q,r,s,n)if s==0 and(q==40 or q==35)and r==25 then local l,m=pcall(c.stop,g)if not l then if m then f.error("Unable to exit program:"..m)end end end end;local e=g:addEvent("touch",p)OSAPI.init()updateList()c.run(g)OSAPI.ignoreListeners()
