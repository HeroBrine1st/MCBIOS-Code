local a=require("filesystem")local b=require("component")local c=b.gpu;local d=require("ECSAPI")local e=require("term")local f=require("unicode")local g=require("zygote")local h=math;local i=require("shell")local j={}local k,l=c.getResolution()local m=require("TabletOSCore")OSAPI.init()c.setBackground(0x610B5E)c.setForeground(0xFFFFFF)c.set(1,1,m.getLanguagePackages().fileManager)b=nil;local n=g.addForm()n.left=1;n.top=2;n.W=80;n.H=23;n.color=0xCCCCCC;local function o()n:setActive()end;local function p(q)g.stop(n)end;local r="/"local s;local t=n:addList(1,2,function(q)local u=q.items[q.index]if a.isDirectory(u)then oldPath=r;r=u;q:clear()q:insert("/","/")q:insert("..",oldPath)for v in a.list(r)do q:insert(v,r..v)end elseif a.exists(u)then s=d.rememberOldPixels(1,1,80,25)local w=g.addForm()w.left=30;w.top=12-2;w.W=20;w.H=5;windowButton1=w:addButton(1,1,"Edit",function()i.execute("edit "..u)d.drawOldPixels(s)o()end)windowButton2=w:addButton(1,2,"Execute",function()e.clear()local x,y=i.execute(u)if not x then d.error(y)end;d.drawOldPixels(s)o()end)windowButton3=w:addButton(1,3,"Remove",function()i.execute("rm "..u)d.drawOldPixels(s)o()end)local function z()g.stop(w)end;windowButton4=w:addButton(1,4,"To workTable",function()a.remove("/usr/table/"..a.name(u))local A=io.open("/usr/table/"..a.name(u),"w")local B=""if not a.path(u):gsub("/","")=="apps"and not a.name(u):gsub("/","")=="shell.lua"and not a.name(u):gsub("/","")=="monitorOnline.lua"then B=B.."require(\"term\").clear()\n"end;B=B.."dofile(\""..u.."\")"A:write(B)A:close()d.drawOldPixels(s)o()end)windowButton5=w:addButton(1,5,"Exit",function()d.drawOldPixels(s)o()end)windowButton1.W=20;windowButton2.W=20;windowButton3.W=20;windowButton4.W=20;windowButton5.W=20;g.run(w)o()end end)t.W=80;t.H=22;t.color=0xCCCCCC;t.fontColor=0xFFFFFF-0xCCCCCC;t.border=0;local function C()local D=t;t:clear()t:insert("/","/")t:insert("..",D.items[2])for v in a.list(r)do t:insert(v,r..v)end;D=nil end;local E=n:addButton(1,1,m.getLanguagePackages().newFolder,function()s=d.rememberOldPixels(1,1,80,25)local w=g.addForm()w.left=30;w.top=25/2-2;w.W=20;w.H=4;local F=w:addEdit(1,1,function(q)local u=q.text;if u then local E=r..u;a.makeDirectory(E)d.drawOldPixels(s)o()C()end end)g.run(w)end)E.W=20;local G=n:addButton(21,1,m.getLanguagePackages().newFile,function()s=d.rememberOldPixels(1,1,80,25)local w=g.addForm()w.left=30;w.top=25/2-2;w.W=20;w.H=4;local F=w:addEdit(1,1,function(q)local u=q.text;if u then local G=r..u;local H=io.open(G,"w")if H then H:write("")H:close()end;d.drawOldPixels(s)o()C()end end)g.run(w)end)G.W=20;local I=n:addButton(41,1,m.getLanguagePackages().updateFileList,C)I.W=20;C()local j;local function J(K,K,L,M,N,K)if N==0 and(L==40 or L==35)and M==25 then local x,y=pcall(p)if not x then if y then d.error("Unable to exit program:"..y)end end end end;local O=n:addEvent("touch",J)g.run(n)
