local a=require("component")local b=a.gpu;local c=require("unicode")local d=require("event")local e=require("ECSAPI")local f={}function f.centerText(g,h,i)local j=g-math.floor(c.len(i)/2)b.set(j,h,i)end;function f.setColors(k,l)return b.setBackground(k),b.setForeground(l)end;function f.drawProgressBar(g,h,m,n,o,p,q)n=n or 0x000000;o=o or 0xFFFFFF;p=p or 0;q=q or 100;local r=1;local s=m/q;local t,u=math.modf(s*p)local v;if u>0.5 then v=t+1 else v=t end;local w=b.setBackground(n)b.fill(g,h,m,1," ")b.setBackground(o)b.fill(g,h,v,1," ")b.setBackground(w)end;function f.animatedProgressBar(g,h,m,n,o,p,q,x)n=n or 0x000000;o=o or 0xFFFFFF;p=p or 0;q=q or 100;local r=1;local s=m/q;local t,u=math.modf(s*p)local v;if u>0.5 then v=t+1 else v=t end;local y=m/q;local z,A=math.modf(y*x)local B;if A>0.5 then B=z+1 else B=z end;local w=b.setBackground(n)b.fill(g,h,m,1," ")b.setBackground(o)for C=B,v do b.fill(g,h,C,1," ")os.sleep(0.05)end;b.setBackground(w)end;function f.clickedAtArea(g,h,D,E,touchX,touchY)if touchX>=g and touchX<=D and touchY>=h and touchY<=E then return true end;return false end;function f.drawButton(g,h,m,r,i,F,G)local w,H=f.setColors(F,G)b.fill(g,h,m,r," ")local I=g+math.floor(m/2)local J=h+math.floor(r/2)f.centerText(I,J,i)f.setColors(w,H)local function K(touchX,touchY)local g,h,m,r=g,h,m,r;local D=g+m;local E=h+r;if touchX>=g and touchX<=D and touchY>=h and touchY<=E then return true end;return false end;return K end;function f.setOnClickListener(g,h,D,E,L)local function M(N,N,g,h,N,N)if f.clickedAtArea(g,h,D,E,touchX,touchY)then pcall(L)end end;local O=d.listen("touch",M)return"touch",M end;function f.callbackButton(g,h,m,r,i,F,G,L)f.drawButton(g,h,m,r,i,F,G)return f.setOnClickListener(g,h,g+m,h+r,L)end;function f.ignoreListener(M)d.ignore(M)end;function f.newProgressBar(g,h,m,n,o,p,q)local P={x=g,y=h,w=m,colorEmpty=n,colorFilled=o,progress=p,maxProgress=q,visible=false,oldPixels=nil}P.oldPixels=e.rememberOldPixels(P.x,P.y,P.x+P.w,P.y)function P.setProgress(p,Q)if Q then if P.visible then f.animatedProgressBar(P.x,P.y,P.w,P.colorEmpty,P.colorFilled,p,P.maxProgress,P.progress)end;P.progress=p else if P.visible then f.drawProgressBar(P.x,P.y,P.w,P.colorEmpty,P.colorFilled,p,P.maxProgress)end;P.progress=p end end;function P.setMaxProgress(q)if P.visible then f.drawProgressBar(P.x,P.y,P.w,P.colorEmpty,P.colorFilled,P.progress,q)end;P.maxProgress=q end;function P.setVisible(R)if R==true then P.visible=true;P.oldPixels=e.rememberOldPixels(P.x,P.y,P.x+P.w,P.y)P.setProgress(P.progress)elseif not R then P.visible=false;e.drawOldPixels(P.oldPixels)P.oldPixels=nil end end;return P end;return f
